<!DOCTYPE html>
<html>
<head>
    <title>Gestione_Permessi</title>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>


</head>
<body>


<form id="add_perm_form" action='/dashboard/gest_perm/add_perm' method="post" enctype="multipart/form-data">
    <label for="text">Nome:</label>
    <input type="text" id="nome" name="nome">
    <br><br>
    <label for="text">Cognome:</label>
    <input type="text" id="cognome" name="cognome">
    <br><br>
    <label for="image">Image :</label>
    <input type="file" id="image1" name="image">
    <br><br>
    <input type="submit" value="Upload">
</form>
<script>
    // this is the id of the form
    $("#add_perm_form").submit(function (e) {
        console.log("submitting form");
        e.preventDefault(); // avoid to execute the actual submit of the form.

        const form = $(this);
        const actionUrl = form.attr('action');

        console.log(form.serialize()); // Debugging code to print out form data

        $.ajax({
            type: "POST",
            url: actionUrl,
            data: new FormData(this), // Use FormData object to include file data
            processData: false,
            contentType: false,
            success: function (data) {
                //se data è "errore" vuol dire che c'è stato un errore
                if (data === "errore") {
                    alert("errore");
                } else {
                    alert("successo");
                    //redirect to gestione permessi
                    window.location.href = "/dashboard/gest_perm";

                }
            }
        });
    });
</script>
</body>
</html>